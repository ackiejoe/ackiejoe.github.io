<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Links</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="theme.js"></script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center justify-start p-6">
  <!-- Header -->
  <header class="w-full flex justify-between items-center mb-6 px-8 py-4 bg-blue-900">
    <h1 class="text-3xl font-bold text-white">My Links</h1>
    <div>
      <select id="themeSelect" class="px-3 py-2 border rounded">
        <option value="dark">Dark Mode</option>
        <option value="light">Light Mode</option>
      </select>
    </div>
  </header>
  <main class="w-full max-w-[1100px] mx-auto">
    <form id="googleSearchForm" class="flex gap-2 mb-4">
  <input type="text" id="googleSearchInput" placeholder="Google Search" class="theme-input w-full" required>
      <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded">Search</button>
    </form>
    <h1 class="text-3xl font-bold mb-6 text-center text-blue-600">My Links</h1>
    <form id="linkForm" class="flex gap-2 mb-6">
  <input type="text" id="linkTitle" placeholder="Title" class="theme-input w-1/3" required>
  <input type="url" id="linkUrl" placeholder="URL" class="theme-input w-1/2" required>
      <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">Add</button>
    </form>
  <div id="linksGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mt-4"></div>
    <!-- Modal -->
    <div id="modalOverlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
      <div id="modalBox" class="bg-white rounded-lg shadow-lg p-6 w-full max-w-sm">
        <h2 id="modalTitle" class="text-xl font-bold mb-4"></h2>
        <form id="modalForm" class="flex flex-col gap-3">
          <input type="text" id="modalLinkTitle" placeholder="Title" class="theme-input" required>
          <input type="url" id="modalLinkUrl" placeholder="URL" class="theme-input" required>
          <div class="flex gap-2 justify-end">
            <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">Save</button>
            <button type="button" id="modalCancel" class="bg-gray-400 text-white px-4 py-2 rounded">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </main>
  <script>
    // Theme logic
    const themes = {
      dark: {
        body: 'bg-gray-900',
        card: 'bg-gray-800',
        text: 'text-gray-100',
        input: 'bg-gray-700 text-gray-100',
        border: 'border-gray-700',
        menu: 'bg-gray-800',
      },
      light: {
        body: 'bg-gray-100',
        card: 'bg-white',
        text: 'text-gray-900',
        input: 'bg-white text-gray-900',
        border: 'border-gray-300',
        menu: 'bg-white',
      }
    };
    function applyTheme(theme) {
      const t = themes[theme];
      document.body.className = `${t.body} min-h-screen flex flex-col items-center justify-start p-6`;
      document.querySelectorAll('.theme-card').forEach(el => {
        el.className = `theme-card ${t.card} rounded-lg shadow flex flex-col items-center justify-center h-32 cursor-pointer transition hover:ring-2 hover:ring-blue-400`;
      });
      document.querySelectorAll('.theme-text').forEach(el => {
        el.className = `theme-text ${t.text} text-sm font-semibold text-center`;
      });
      document.querySelectorAll('.theme-input').forEach(el => {
        el.className = `theme-input px-3 py-2 rounded ${t.input} ${t.border}`;
      });
      document.querySelectorAll('.theme-border').forEach(el => {
        el.className = `theme-border ${t.border}`;
      });
      document.querySelectorAll('.theme-menu').forEach(el => {
        el.className = `absolute top-8 right-2 theme-menu theme-border rounded shadow-lg z-10 hidden flex-col ${t.menu}`;
      });
      document.getElementById('modalBox').className = `${t.card} rounded-lg shadow-lg p-6 w-full max-w-sm`;
      document.getElementById('modalTitle').className = `text-xl font-bold mb-4 ${t.text}`;
    }
    function getTheme() {
      return localStorage.getItem('linksTheme') || 'dark';
    }
    function setTheme(theme) {
      localStorage.setItem('linksTheme', theme);
      applyTheme(theme);
      document.getElementById('themeSelect').value = theme;
    }
    document.getElementById('themeSelect').onchange = function() {
      setTheme(this.value);
    };
    // Initial theme
    setTheme(getTheme());
    // Google search form handler
    document.getElementById('googleSearchForm').onsubmit = function(e) {
      e.preventDefault();
      const query = document.getElementById('googleSearchInput').value.trim();
      if (query) {
        window.open('https://www.google.com/search?q=' + encodeURIComponent(query), '_blank');
        this.reset();
      }
    };
    // Load links from localStorage
    function getLinks() {
      return JSON.parse(localStorage.getItem('myLinks') || '[]');
    }
    function saveLinks(links) {
      localStorage.setItem('myLinks', JSON.stringify(links));
    }
    function renderLinks() {
      const links = getLinks();
      const grid = document.getElementById('linksGrid');
      grid.innerHTML = '';
      links.forEach((link, idx) => {
        const square = document.createElement('div');
        square.className = 'relative group theme-card';
        square.innerHTML = `
          <a href="${link.url}" target="_blank" class="flex flex-col items-center justify-center w-full h-full">
            <div class="flex items-center justify-center w-12 h-12 rounded-full bg-blue-100 mb-2">
              <svg class="w-8 h-8 text-blue-500" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a8 8 0 100 16 8 8 0 000-16zm1 11H9v-1h2v1zm0-2H9V7h2v4z"/></svg>
            </div>
            <span class="theme-text">${link.title}</span>
          </a>
          <button class="absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition" data-menu="${idx}">
            <svg class="w-6 h-6 text-gray-500" fill="currentColor" viewBox="0 0 20 20"><circle cx="4" cy="10" r="2"/><circle cx="10" cy="10" r="2"/><circle cx="16" cy="10" r="2"/></svg>
          </button>
          <div class="absolute top-8 right-2 theme-menu theme-border rounded shadow-lg z-10 hidden flex-col" id="menu-${idx}">
            <button class="px-4 py-2 text-left hover:bg-gray-100 w-full" data-edit="${idx}">Edit</button>
            <button class="px-4 py-2 text-left hover:bg-gray-100 w-full" data-delete="${idx}">Delete</button>
            <button class="px-4 py-2 text-left hover:bg-gray-100 w-full" data-add>New</button>
          </div>
        `;
        grid.appendChild(square);
      });
      applyTheme(getTheme());
    }
    document.getElementById('linkForm').onsubmit = function(e) {
      e.preventDefault();
      const title = document.getElementById('linkTitle').value.trim();
      const url = document.getElementById('linkUrl').value.trim();
      if (!title || !url) return;
      const links = getLinks();
      links.push({ title, url });
      saveLinks(links);
      renderLinks();
      this.reset();
    };
    // Menu logic
    let openMenu = null;
    document.getElementById('linksGrid').onclick = function(e) {
      // Show/hide menu
      if (e.target.closest('button[data-menu]')) {
        const idx = e.target.closest('button[data-menu]').dataset.menu;
        document.querySelectorAll('[id^="menu-"]').forEach(m => m.classList.add('hidden'));
        const menu = document.getElementById('menu-' + idx);
        menu.classList.toggle('hidden');
        openMenu = menu.classList.contains('hidden') ? null : menu;
        return;
      }
      // Edit
      if (e.target.dataset.edit !== undefined) {
        const idx = +e.target.dataset.edit;
        const links = getLinks();
        showModal('Edit Link', links[idx].title, links[idx].url, idx);
        if (openMenu) openMenu.classList.add('hidden');
        openMenu = null;
        return;
      }
      // Delete
      if (e.target.dataset.delete !== undefined) {
        const idx = +e.target.dataset.delete;
        const links = getLinks();
        links.splice(idx, 1);
        saveLinks(links);
        renderLinks();
        if (openMenu) openMenu.classList.add('hidden');
        openMenu = null;
        return;
      }
      // Add new
      if (e.target.dataset.add !== undefined) {
        showModal('Add New Link', '', '', null);
        if (openMenu) openMenu.classList.add('hidden');
        openMenu = null;
        return;
      }
    };
    // Close menu on outside click
    document.addEventListener('click', function(e) {
      if (openMenu && !e.target.closest('.group')) {
        openMenu.classList.add('hidden');
        openMenu = null;
      }
    });
    // Modal logic
    function showModal(title, linkTitle, linkUrl, idx) {
      document.getElementById('modalTitle').textContent = title;
      document.getElementById('modalLinkTitle').value = linkTitle || '';
      document.getElementById('modalLinkUrl').value = linkUrl || '';
      document.getElementById('modalOverlay').classList.remove('hidden');
      document.getElementById('modalForm').onsubmit = function(e) {
        e.preventDefault();
        const title = document.getElementById('modalLinkTitle').value.trim();
        const url = document.getElementById('modalLinkUrl').value.trim();
        if (!title || !url) return;
        const links = getLinks();
        if (idx !== null) {
          links[idx] = { title, url };
        } else {
          links.push({ title, url });
        }
        saveLinks(links);
        renderLinks();
        document.getElementById('modalOverlay').classList.add('hidden');
      };
      document.getElementById('modalCancel').onclick = function() {
        document.getElementById('modalOverlay').classList.add('hidden');
      };
    }
    renderLinks();
  </script>
</body>
</html>
